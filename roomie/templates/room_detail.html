<!-- filepath: c:\Users\saaud\Documents\GitHub\RoomiePlatform\roomie\templates\room_detail.html -->
{% extends 'base.html' %} {% load static %} {% block content %}
<div class="container py-5">
  <!-- Breadcrumb navigation -->
  <nav aria-label="breadcrumb" class="mb-4">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
      <li class="breadcrumb-item">
        <a href="{% url 'filter_rooms' %}">Rooms</a>
      </li>
      <li class="breadcrumb-item active" aria-current="page">
        {{ room.title }}
      </li>
    </ol>
  </nav>

  <div class="row g-4">
    <!-- Room Image and Details -->
    <div class="col-lg-8">
      <!-- Image Gallery -->
      <div class="card shadow-sm mb-4 overflow-hidden">
        <div class="position-relative">
          {% if room.image %}
          <img
            src="{{ room.image.url }}"
            class="card-img-top room-detail-image"
            alt="{{ room.title }}"
          />
          {% else %}
          <img
            src="/media/images/default_room.jpg"
            class="card-img-top room-detail-image"
            alt="Default Room Image"
          />
          {% endif %}

          <!-- Availability badge -->
          <div
            class="room-availability-badge {% if room.is_available %}bg-success{% else %}bg-danger{% endif %}"
          >
            {% if room.is_available %}Available{% else %}Not Available{% endif
            %}
          </div>

          <!-- Price badge -->
          <div class="room-price">
            <div class="price-amount">${{ room.rent }}</div>
            <div class="price-period">/ month</div>
          </div>
        </div>
      </div>

      <!-- Room Details Card -->
      <div class="card shadow-sm mb-4">
        <div class="card-header bg-transparent">
          <div class="d-flex justify-content-between align-items-center">
            <h2 class="card-title h3 mb-0">{{ room.title }}</h2>
            <a
              href="{% url 'user_profile' room.provider.id %}"
              class="provider-link"
            >
              <div class="d-flex align-items-center">
                {% if room.provider.profile_photo %}
                <img
                  src="{{ room.provider.profile_photo.url }}"
                  class="provider-photo"
                  alt="{{ room.provider.username }}"
                />
                {% else %}
                <img
                  src="/media/profile_photos/default_user.jpg"
                  class="provider-photo"
                  alt="Default Profile"
                />
                {% endif %}
                <span class="ms-2">{{ room.provider.username }}</span>
              </div>
            </a>
          </div>
        </div>
        <div class="card-body">
          <!-- Room details summary -->
          <div class="room-features mb-4">
            <div class="feature">
              <i class="fas fa-map-marker-alt feature-icon"></i>
              <div>
                <h6 class="feature-title">Location</h6>
                <p class="feature-value">{{ room.location }}</p>
              </div>
            </div>

            <div class="feature">
              <i class="fas fa-bed feature-icon"></i>
              <div>
                <h6 class="feature-title">Room Type</h6>
                <p class="feature-value">{{ room.get_room_type_display }}</p>
              </div>
            </div>

            <div class="feature">
              <i class="fas fa-door-open feature-icon"></i>
              <div>
                <h6 class="feature-title">Bedrooms</h6>
                <p class="feature-value">{{ room.bedrooms }}</p>
              </div>
            </div>
          </div>

          <!-- Description -->
          <div class="mb-4">
            <h5 class="border-bottom pb-2 mb-3">Description</h5>
            <p>{{ room.description|linebreaks }}</p>
          </div>

          <!-- Amenities -->
          <h5 class="border-bottom pb-2 mb-3">Amenities</h5>
          <div class="row">
            <div class="col-md-6">
              <ul class="amenities-list">
                <li><i class="fas fa-wifi me-2"></i> Free WiFi</li>
                <li><i class="fas fa-utensils me-2"></i> Kitchen</li>
                <li><i class="fas fa-tv me-2"></i> TV</li>
              </ul>
            </div>
            <div class="col-md-6">
              <ul class="amenities-list">
                <li><i class="fas fa-parking me-2"></i> Parking</li>
                <li><i class="fas fa-snowflake me-2"></i> Air Conditioning</li>
                <li><i class="fas fa-tshirt me-2"></i> Laundry</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- Google Map (placeholder) -->
      <div class="card shadow-sm">
        <div class="card-body p-0">
          <div class="map-placeholder">
            <i class="fas fa-map-marked-alt map-icon"></i>
            <p class="mb-0">Map view is available after booking</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Booking Section & Contact -->
    <div class="col-lg-4">
      <!-- Booking Card -->
      <div class="card shadow-sm mb-4">
        <div class="card-header bg-primary text-white py-3">
          <h4 class="card-title mb-0 text-center">Book This Room</h4>
        </div>
        <div class="card-body">
          <div class="booking-price mb-4">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <h5 class="mb-0">${{ room.rent }} / month</h5>
              <span
                class="badge {% if room.is_available %}bg-success{% else %}bg-danger{% endif %}"
              >
                {% if room.is_available %}Available{% else %}Not Available{%
                endif %}
              </span>
            </div>
          </div>

          {% if user.is_authenticated and user.account_type == 'seeker' %} {% if
          room.is_available %}
          <a
            href="{% url 'book_room' room.room_id %}"
            class="btn btn-primary btn-lg w-100 mb-3"
          >
            <i class="fas fa-calendar-check me-2"></i> Book Now
          </a>
          {% else %}
          <button class="btn btn-secondary btn-lg w-100 mb-3" disabled>
            <i class="fas fa-ban me-2"></i> Not Available
          </button>
          {% endif %} {% else %}
          <div class="alert alert-info mb-3">
            <i class="fas fa-info-circle me-2"></i>
            {% if user.is_authenticated %} You must be a seeker to book this
            room. {% else %} Please
            <a href="{% url 'login' %}" class="alert-link">log in</a> as a
            seeker to book this room. {% endif %}
          </div>
          {% endif %}

          <!-- Contact provider -->
          <div class="text-center">
            {% if user.is_authenticated and user.account_type == 'seeker' %}
            <a
              href="{% url 'send_message' room.provider.id %}"
              class="btn btn-outline-primary w-100"
            >
              <i class="fas fa-envelope me-2"></i> Contact Provider
            </a>
            {% else %}
            <p class="text-muted small">
              <i class="fas fa-lock me-1"></i> Log in as a seeker to contact the
              provider
            </p>
            {% endif %}
          </div>
        </div>
      </div>

      <!-- Help & Support -->
      <div class="card shadow-sm mb-4">
        <div class="card-header bg-transparent">
          <h5 class="card-title mb-0">
            <i class="fas fa-question-circle text-primary me-2"></i> Need Help?
          </h5>
        </div>
        <div class="card-body">
          <p class="mb-3">
            Have questions about this property or the booking process?
          </p>
          <div class="d-grid gap-2">
            <a
              href="{% url 'submit_support_ticket' %}?type=seeker"
              class="btn btn-outline-secondary"
            >
              <i class="fas fa-headset me-2"></i> Contact Support
            </a>
          </div>
        </div>
      </div>

      <!-- Safety Tips -->
      <div class="card shadow-sm">
        <div class="card-header bg-transparent">
          <h5 class="card-title mb-0">
            <i class="fas fa-shield-alt text-primary me-2"></i> Safety Tips
          </h5>
        </div>
        <div class="card-body">
          <ul class="safety-tips">
            <li>Always visit the property before booking</li>
            <li>Meet the provider in person or via video call</li>
            <li>Ask about all utilities and additional costs</li>
            <li>Review any contracts before signing</li>
            <li>Keep all communication on our platform</li>
          </ul>
          <a href="#" class="btn btn-link btn-sm p-0"
            >Learn more about safe booking</a
          >
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  /* Room detail specific styles */
  .room-detail-image {
    height: 500px;
    object-fit: cover;
  }

  .room-availability-badge {
    position: absolute;
    top: 20px;
    left: 20px;
    color: white;
    padding: 5px 15px;
    border-radius: 20px;
    font-weight: 600;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .room-price {
    position: absolute;
    top: 20px;
    right: 20px;
    background: rgba(25, 135, 84, 0.9);
    color: white;
    padding: 10px 15px;
    border-radius: 8px;
    font-weight: 600;
    text-align: center;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
  }

  .provider-link {
    color: inherit;
    text-decoration: none;
  }

  .provider-photo {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    object-fit: cover;
  }

  .room-features {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    margin-bottom: 30px;
  }

  .feature {
    display: flex;
    align-items: flex-start;
  }

  .feature-icon {
    width: 40px;
    height: 40px;
    background-color: rgba(13, 110, 253, 0.1);
    color: var(--primary-color);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 15px;
    font-size: 1.1rem;
  }

  .feature-title {
    font-size: 0.875rem;
    font-weight: 500;
    color: #6c757d;
    margin-bottom: 0.25rem;
  }

  .feature-value {
    font-weight: 600;
    margin-bottom: 0;
  }

  .amenities-list {
    list-style: none;
    padding-left: 0;
  }

  .amenities-list li {
    margin-bottom: 10px;
    color: #495057;
  }

  .safety-tips {
    padding-left: 20px;
  }

  .safety-tips li {
    margin-bottom: 8px;
    font-size: 0.9rem;
  }

  .map-placeholder {
    background-color: #f8f9fa;
    height: 200px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: #6c757d;
  }

  .map-icon {
    font-size: 3rem;
    margin-bottom: 10px;
    opacity: 0.5;
  }

  @media (max-width: 992px) {
    .room-features {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (max-width: 576px) {
    .room-features {
      grid-template-columns: 1fr;
    }

    .room-detail-image {
      height: 300px;
    }
  }
</style>
{% endblock %}
